name: Weekly Drug Approval & AI Analysis

on:
  schedule:
    - cron: '0 12 * * 5' # ë§¤ì£¼ ê¸ˆìš”ì¼ ë°¤ 9ì‹œ
  workflow_dispatch:      # ìˆ˜ë™ ì‹¤í–‰ ë²„íŠ¼

jobs:
  scrape-and-analyze:
    runs-on: ubuntu-latest
    steps:
      - name: 1. ì½”ë“œ ì²´í¬ì•„ì›ƒ
        uses: actions/checkout@v3

      - name: 2. íŒŒì´ì¬ ì„¤ì • (3.11ë¡œ ì—…ê·¸ë ˆì´ë“œ!)
        uses: actions/setup-python@v4
        with:
          python-version: '3.11'  # ğŸŒŸ ì—¬ê¸°ë¥¼ 3.11ë¡œ ë°”ê¾¸ë©´ ê²½ê³  ë!

      - name: 3. ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜
        run: |
          pip install -U requests beautifulsoup4 supabase google-generativeai

      - name: 4. ë°ì´í„° ìˆ˜ì§‘ (Scraper)
        env:
          SUPABASE_URL: ${{ secrets.SUPABASE_URL }}
          SUPABASE_KEY: ${{ secrets.SUPABASE_KEY }}
        run: python scraper.py

      - name: 5. AI ë°ì´í„° ë¶„ì„ (Gemini)
        env:
          SUPABASE_URL: ${{ secrets.SUPABASE_URL }}
          SUPABASE_KEY: ${{ secrets.SUPABASE_KEY }}
          GEMINI_API_KEY: ${{ secrets.GEMINI_API_KEY }}
        run: python ai_analyst.py
